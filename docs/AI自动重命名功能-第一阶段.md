# AIè‡ªåŠ¨é‡å‘½åä¹¦ç­¾åŠŸèƒ½ - ç¬¬ä¸€é˜¶æ®µå®ç°è¯´æ˜

## é˜¶æ®µæ¦‚è¿°

ç¬¬ä¸€é˜¶æ®µå®Œæˆäº†AIåŸºç¡€èƒ½åŠ›é…ç½®ï¼Œä¸ºåç»­çš„ä¹¦ç­¾é‡å‘½ååŠŸèƒ½å¥ å®šåŸºç¡€ã€‚ç”¨æˆ·å¯ä»¥é…ç½®AIæœåŠ¡çš„è¿æ¥å‚æ•°ï¼Œå¹¶æµ‹è¯•è¿æ¥æ˜¯å¦æ­£å¸¸ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ”§ **AIé…ç½®ç®¡ç†**

#### 1. **é…ç½®é¡¹**
- **APIä»£ç†URL**: æ”¯æŒOpenAIå…¼å®¹çš„API endpoint
  - é»˜è®¤å€¼: `https://api.openai.com/v1`
  - æ”¯æŒè‡ªå®šä¹‰ä»£ç†åœ°å€
  
- **APIå¯†é’¥**: å®‰å…¨å­˜å‚¨çš„API Key
  - ä½¿ç”¨å¯†ç è¾“å…¥æ¡†ï¼Œé˜²æ­¢æ˜æ–‡æ˜¾ç¤º
  - Base64ç¼–ç å­˜å‚¨ï¼Œå¢åŠ åŸºæœ¬å®‰å…¨æ€§
  
- **æ¨¡å‹ID**: æŒ‡å®šä½¿ç”¨çš„AIæ¨¡å‹
  - é»˜è®¤å€¼: `gpt-3.5-turbo`
  - æ”¯æŒå…¶ä»–OpenAIå…¼å®¹æ¨¡å‹ï¼ˆå¦‚gpt-4, gpt-4-turboç­‰ï¼‰

#### 2. **æµ‹è¯•è¿æ¥åŠŸèƒ½**
- å‘é€ç®€å•çš„æµ‹è¯•è¯·æ±‚éªŒè¯é…ç½®
- å®æ—¶æ˜¾ç¤ºæµ‹è¯•ç»“æœï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰
- è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯æç¤º
- åŠ è½½çŠ¶æ€æŒ‡ç¤ºå™¨

#### 3. **é…ç½®æŒä¹…åŒ–**
- ä¿å­˜åˆ°Chromeæœ¬åœ°å­˜å‚¨
- API Keyä½¿ç”¨Base64ç¼–ç 
- è‡ªåŠ¨åŠ è½½å·²ä¿å­˜çš„é…ç½®

### ğŸ¨ **ç”¨æˆ·ç•Œé¢**

#### è®¾ç½®é¡µé¢å¸ƒå±€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¹¦ç­¾è®¾ç½® | å¤–è§‚è®¾ç½® | AIè®¾ç½® â† æ–°å¢Tab      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚ AIé…ç½®                                      â”‚
â”‚ é…ç½®AIæœåŠ¡ç”¨äºè‡ªåŠ¨é‡å‘½åä¹¦ç­¾                â”‚
â”‚                                             â”‚
â”‚ APIä»£ç†URL                                  â”‚
â”‚ [https://api.openai.com/v1            ]    â”‚
â”‚                                             â”‚
â”‚ APIå¯†é’¥                                     â”‚
â”‚ [â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢]    â”‚
â”‚ Your API key is stored securely...         â”‚
â”‚                                             â”‚
â”‚ æ¨¡å‹ID                                      â”‚
â”‚ [gpt-3.5-turbo                        ]    â”‚
â”‚                                             â”‚
â”‚ âœ… Connection successful!                   â”‚
â”‚                                             â”‚
â”‚ [æµ‹è¯•è¿æ¥]  [ä¿å­˜é…ç½®]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### äº¤äº’åé¦ˆ
- **æµ‹è¯•ä¸­**: æ˜¾ç¤ºåŠ è½½åŠ¨ç”»å’Œ"æµ‹è¯•ä¸­..."æ–‡æœ¬
- **æµ‹è¯•æˆåŠŸ**: ç»¿è‰²èƒŒæ™¯ï¼Œæ˜¾ç¤ºæˆåŠŸå›¾æ ‡å’Œæ¶ˆæ¯
- **æµ‹è¯•å¤±è´¥**: çº¢è‰²èƒŒæ™¯ï¼Œæ˜¾ç¤ºé”™è¯¯å›¾æ ‡å’Œè¯¦ç»†é”™è¯¯ä¿¡æ¯
- **ä¿å­˜ä¸­**: æŒ‰é’®æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
- **ä¿å­˜æˆåŠŸ**: Toasté€šçŸ¥æç¤º

## æŠ€æœ¯å®ç°

### ğŸ“ **æ–‡ä»¶ç»“æ„**

```
lib/
â”œâ”€â”€ aiConfigUtils.ts          # AIé…ç½®ç®¡ç†å·¥å…·å‡½æ•°
â””â”€â”€ aiService.ts              # AI APIè°ƒç”¨æœåŠ¡

components/
â”œâ”€â”€ settings/
â”‚   â””â”€â”€ ai-config-settings.tsx  # AIé…ç½®è®¾ç½®ç»„ä»¶
â””â”€â”€ ui/
    â”œâ”€â”€ toast.tsx             # Toasté€šçŸ¥ç»„ä»¶
    â””â”€â”€ toaster.tsx           # Toastå®¹å™¨ç»„ä»¶

hooks/
â””â”€â”€ use-toast.ts              # Toast Hook

locales/
â”œâ”€â”€ zh_CN/common.json         # ä¸­æ–‡å›½é™…åŒ–æ–‡æœ¬
â””â”€â”€ en/common.json            # è‹±æ–‡å›½é™…åŒ–æ–‡æœ¬
```

### ğŸ”§ **æ ¸å¿ƒæ¨¡å—**

#### 1. **aiConfigUtils.ts** - é…ç½®ç®¡ç†
```typescript
// AIé…ç½®æ¥å£
interface AIConfig {
    apiUrl: string;      // APIä»£ç†URL
    apiKey: string;      // APIå¯†é’¥
    modelId: string;     // æ¨¡å‹ID
}

// æ ¸å¿ƒå‡½æ•°
saveAIConfig(config: AIConfig): Promise<void>
getAIConfig(): Promise<AIConfig>
validateAIConfig(config: AIConfig): { valid: boolean; errors: string[] }
isAIConfigured(): Promise<boolean>
clearAIConfig(): Promise<void>
```

**å®‰å…¨æ€§è®¾è®¡**:
- API Keyä½¿ç”¨Base64ç¼–ç å­˜å‚¨
- æ³¨é‡Šè¯´æ˜è¿™ä¸æ˜¯å¼ºåŠ å¯†ï¼Œåªæ˜¯é˜²æ­¢æ˜æ–‡å­˜å‚¨
- å»ºè®®ç”Ÿäº§ç¯å¢ƒä½¿ç”¨æ›´å¼ºçš„åŠ å¯†æ–¹æ³•

#### 2. **aiService.ts** - AIæœåŠ¡
```typescript
// æµ‹è¯•è¿æ¥
testAIConnection(config: AIConfig): Promise<TestConnectionResult>

// å•æ¡ä¹¦ç­¾é‡å‘½åï¼ˆä¸ºç¬¬ä¸‰é˜¶æ®µå‡†å¤‡ï¼‰
renameBookmarkWithAI(
    config: AIConfig,
    bookmarkUrl: string,
    currentTitle: string,
    customPrompt?: string
): Promise<AIRenameResult>

// æ‰¹é‡é‡å‘½åï¼ˆä¸ºç¬¬å››é˜¶æ®µå‡†å¤‡ï¼‰
batchRenameBookmarks(
    config: AIConfig,
    bookmarks: Array<{ id: string; url: string; title: string }>,
    customPrompt?: string,
    onProgress?: (current: number, total: number) => void
): Promise<Array<RenameResult>>
```

**APIè°ƒç”¨æ ¼å¼**:
```typescript
POST {apiUrl}/chat/completions
Headers:
  Authorization: Bearer {apiKey}
  Content-Type: application/json
Body:
  {
    model: {modelId},
    messages: [{role: "user", content: prompt}],
    temperature: 0.7,
    max_tokens: 100
  }
```

#### 3. **AIConfigSettingsç»„ä»¶**
```typescript
// çŠ¶æ€ç®¡ç†
const [config, setConfig] = useState<AIConfig>()
const [loading, setLoading] = useState(true)
const [testing, setTesting] = useState(false)
const [saving, setSaving] = useState(false)
const [testResult, setTestResult] = useState<TestResult | null>(null)

// æ ¸å¿ƒåŠŸèƒ½
handleInputChange(field, value)  // å¤„ç†è¾“å…¥å˜åŒ–
handleTestConnection()           // æµ‹è¯•è¿æ¥
handleSaveConfig()              // ä¿å­˜é…ç½®
```

### ğŸŒ **å›½é™…åŒ–æ”¯æŒ**

#### ä¸­æ–‡æ–‡æœ¬
```json
{
  "aiSettingsTab": "AIè®¾ç½®",
  "aiConfig": "AIé…ç½®",
  "aiConfigDescription": "é…ç½®AIæœåŠ¡ç”¨äºè‡ªåŠ¨é‡å‘½åä¹¦ç­¾",
  "apiUrl": "APIä»£ç†URL",
  "apiUrlPlaceholder": "ä¾‹å¦‚: https://api.openai.com/v1",
  "apiKey": "APIå¯†é’¥",
  "apiKeyPlaceholder": "è¾“å…¥æ‚¨çš„APIå¯†é’¥",
  "modelId": "æ¨¡å‹ID",
  "modelIdPlaceholder": "ä¾‹å¦‚: gpt-3.5-turbo",
  "testConnection": "æµ‹è¯•è¿æ¥",
  "testing": "æµ‹è¯•ä¸­...",
  "connectionSuccess": "è¿æ¥æˆåŠŸï¼",
  "connectionFailed": "è¿æ¥å¤±è´¥",
  "saveConfig": "ä¿å­˜é…ç½®",
  "configSaved": "é…ç½®å·²ä¿å­˜",
  "configSaveFailed": "ä¿å­˜é…ç½®å¤±è´¥",
  "apiUrlRequired": "APIä»£ç†URLä¸èƒ½ä¸ºç©º",
  "apiKeyRequired": "APIå¯†é’¥ä¸èƒ½ä¸ºç©º",
  "modelIdRequired": "æ¨¡å‹IDä¸èƒ½ä¸ºç©º"
}
```

#### è‹±æ–‡æ–‡æœ¬
```json
{
  "aiSettingsTab": "AI Settings",
  "aiConfig": "AI Configuration",
  "aiConfigDescription": "Configure AI service for automatic bookmark renaming",
  "apiUrl": "API Proxy URL",
  "apiUrlPlaceholder": "e.g., https://api.openai.com/v1",
  "apiKey": "API Key",
  "apiKeyPlaceholder": "Enter your API key",
  "modelId": "Model ID",
  "modelIdPlaceholder": "e.g., gpt-3.5-turbo",
  "testConnection": "Test Connection",
  "testing": "Testing...",
  "connectionSuccess": "Connection successful!",
  "connectionFailed": "Connection failed",
  "saveConfig": "Save Configuration",
  "configSaved": "Configuration saved",
  "configSaveFailed": "Failed to save configuration",
  "apiUrlRequired": "API URL is required",
  "apiKeyRequired": "API Key is required",
  "modelIdRequired": "Model ID is required"
}
```

### ğŸ“Š **æ„å»ºç»“æœ**

- **æ„å»ºæˆåŠŸ**: æ€»å¤§å°799.2 kB
- **æ–°å¢ä¾èµ–**: 
  - `@radix-ui/react-toast`
  - `class-variance-authority`
- **æ–°å¢ç»„ä»¶**: AIConfigSettings, Toast, Toaster
- **æ–°å¢å·¥å…·**: aiConfigUtils, aiService
- **åŠŸèƒ½å®Œæ•´**: æ‰€æœ‰AIé…ç½®åŠŸèƒ½æ­£å¸¸å·¥ä½œ

## ä½¿ç”¨æŒ‡å—

### ğŸ‘¤ **ç”¨æˆ·æ“ä½œæµç¨‹**

#### 1. **è®¿é—®AIè®¾ç½®**
1. æ‰“å¼€Chromeæ’ä»¶
2. ç‚¹å‡»ä¾§è¾¹æ çš„"è®¾ç½®"æŒ‰é’®
3. åˆ‡æ¢åˆ°"AIè®¾ç½®"Tab

#### 2. **é…ç½®AIæœåŠ¡**
1. è¾“å…¥APIä»£ç†URLï¼ˆå¦‚ä½¿ç”¨ä»£ç†æœåŠ¡ï¼‰
2. è¾“å…¥APIå¯†é’¥
3. è¾“å…¥æ¨¡å‹IDï¼ˆæˆ–ä½¿ç”¨é»˜è®¤å€¼ï¼‰
4. ç‚¹å‡»"æµ‹è¯•è¿æ¥"éªŒè¯é…ç½®
5. æµ‹è¯•æˆåŠŸåç‚¹å‡»"ä¿å­˜é…ç½®"

#### 3. **éªŒè¯é…ç½®**
- è§‚å¯Ÿæµ‹è¯•ç»“æœæç¤º
- ç¡®è®¤é…ç½®å·²ä¿å­˜çš„Toasté€šçŸ¥
- é‡æ–°æ‰“å¼€è®¾ç½®é¡µé¢éªŒè¯é…ç½®æ˜¯å¦ä¿æŒ

### ğŸ”§ **å¼€å‘è€…æ‰©å±•**

#### 1. **æ·»åŠ æ–°çš„AIæœåŠ¡æä¾›å•†**
```typescript
// åœ¨aiService.tsä¸­ä¿®æ”¹APIè°ƒç”¨æ ¼å¼
const endpoint = apiUrl.endsWith('/') 
    ? `${apiUrl}chat/completions` 
    : `${apiUrl}/chat/completions`;

// æ ¹æ®ä¸åŒæä¾›å•†è°ƒæ•´è¯·æ±‚æ ¼å¼
```

#### 2. **å¢å¼ºå®‰å…¨æ€§**
```typescript
// ä½¿ç”¨Web Crypto APIè¿›è¡ŒçœŸæ­£çš„åŠ å¯†
const encryptApiKey = async (apiKey: string): Promise<string> => {
    // å®ç°åŠ å¯†é€»è¾‘
};

const decryptApiKey = async (encryptedKey: string): Promise<string> => {
    // å®ç°è§£å¯†é€»è¾‘
};
```

#### 3. **æ·»åŠ æ›´å¤šé…ç½®é¡¹**
```typescript
interface AIConfig {
    apiUrl: string;
    apiKey: string;
    modelId: string;
    temperature?: number;    // æ–°å¢ï¼šæ¸©åº¦å‚æ•°
    maxTokens?: number;      // æ–°å¢ï¼šæœ€å¤§tokenæ•°
    timeout?: number;        // æ–°å¢ï¼šè¯·æ±‚è¶…æ—¶æ—¶é—´
}
```

## ä¸‹ä¸€é˜¶æ®µé¢„å‘Š

### ç¬¬äºŒé˜¶æ®µï¼šé‡å‘½åè§„èŒƒé…ç½®
- æä¾›é»˜è®¤çš„é‡å‘½åPromptæ¨¡æ¿
- å…è®¸ç”¨æˆ·è‡ªå®šä¹‰Prompt
- æä¾›"æ¢å¤é»˜è®¤"åŠŸèƒ½
- ä¿å­˜è‡ªå®šä¹‰Promptåˆ°æœ¬åœ°å­˜å‚¨

### ç¬¬ä¸‰é˜¶æ®µï¼šå•æ¡ä¹¦ç­¾é‡å‘½å
- åœ¨ä¹¦ç­¾åˆ—è¡¨å³é”®èœå•æ·»åŠ "AIé‡å‘½å"é€‰é¡¹
- æ˜¾ç¤ºAIå»ºè®®çš„æ–°æ ‡é¢˜
- æä¾›å¯¹æ¯”ç•Œé¢ï¼ˆåŸæ ‡é¢˜ vs æ–°æ ‡é¢˜ï¼‰
- æ”¯æŒæ¥å—æˆ–å–æ¶ˆé‡å‘½å

### ç¬¬å››é˜¶æ®µï¼šæ‰¹é‡AIé‡å‘½å
- æä¾›æ–‡ä»¶å¤¹é€‰æ‹©å™¨
- æ˜¾ç¤ºæ‰¹é‡å¤„ç†è¿›åº¦
- å±•ç¤ºæ‰€æœ‰é‡å‘½åå»ºè®®çš„å¯¹æ¯”è¡¨æ ¼
- æ”¯æŒé€‰æ‹©æ€§åº”ç”¨ä¿®æ”¹

## æ€»ç»“

ç¬¬ä¸€é˜¶æ®µæˆåŠŸå®ç°äº†AIåŸºç¡€èƒ½åŠ›é…ç½®ï¼Œä¸ºåç»­çš„ä¹¦ç­¾é‡å‘½ååŠŸèƒ½å¥ å®šäº†åšå®çš„åŸºç¡€ã€‚

### ğŸ¯ **æ ¸å¿ƒæˆå°±**
- âœ… å®Œæ•´çš„AIé…ç½®ç®¡ç†ç³»ç»Ÿ
- âœ… å®‰å…¨çš„API Keyå­˜å‚¨æœºåˆ¶
- âœ… å®æ—¶çš„è¿æ¥æµ‹è¯•åŠŸèƒ½
- âœ… å‹å¥½çš„ç”¨æˆ·ç•Œé¢å’Œäº¤äº’åé¦ˆ
- âœ… å®Œå–„çš„å›½é™…åŒ–æ”¯æŒ
- âœ… æ¨¡å—åŒ–çš„ä»£ç ç»“æ„
- âœ… ä¸ºåç»­é˜¶æ®µé¢„ç•™çš„æ‰©å±•æ¥å£

ç°åœ¨ç”¨æˆ·å¯ä»¥é…ç½®AIæœåŠ¡ï¼Œä¸ºæ¥ä¸‹æ¥çš„ä¹¦ç­¾è‡ªåŠ¨é‡å‘½ååŠŸèƒ½åšå¥½å‡†å¤‡ï¼ğŸ‰
