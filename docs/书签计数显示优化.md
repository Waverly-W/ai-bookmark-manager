# 书签计数显示优化

## 🎯 问题背景

在AI批量重命名页面中，"找到 {count} 个书签"等包含数字占位符的文本无法正确显示，占位符 `{count}` 没有被实际数字替换。由于国际化占位符的问题比较复杂，我们采用了更直接的方式来规避这个问题。

## ✅ 解决方案

### 策略：拆分文本 + 数字拼接

将原来使用占位符的文本拆分为多个独立的翻译文本，然后通过字符串拼接的方式组合显示。

#### 原方案（有问题）
```typescript
// 翻译文件
"bookmarksFound": "找到 {count} 个书签"

// 代码使用
t('bookmarksFound', { count: bookmarks.length })
// 显示结果: "找到 {count} 个书签" (占位符未替换)
```

#### 新方案（可靠）
```typescript
// 翻译文件
"foundText": "找到",
"bookmarksText": "个书签"

// 代码使用
`${t('foundText')} ${bookmarks.length} ${t('bookmarksText')}`
// 显示结果: "找到 5 个书签" (正确显示)
```

## 🔧 具体修改内容

### 1. **批量重命名页面 - Alert显示**

#### 修改文件：`entrypoints/newtab/batch-rename.tsx`

**修改前**：
```typescript
<AlertDescription>
    {t('bookmarksFound', { count: bookmarks.length })}
</AlertDescription>
```

**修改后**：
```typescript
<AlertDescription>
    {t('foundText')} {bookmarks.length} {t('bookmarksText')}
</AlertDescription>
```

### 2. **批量重命名页面 - Toast通知**

**修改前**：
```typescript
toast({
    title: t('folderSelected'),
    description: t('bookmarksFound', { count: folderBookmarks.length }),
});
```

**修改后**：
```typescript
toast({
    title: t('folderSelected'),
    description: `${t('foundText')} ${folderBookmarks.length} ${t('bookmarksText')}`,
});
```

### 3. **批量重命名成功通知**

**修改前**：
```typescript
toast({
    title: t('batchRenameSuccess', { count: successCount }),
    description: t('bookmarksUpdated'),
});
```

**修改后**：
```typescript
toast({
    title: `${t('successfullyRenamed')} ${successCount} ${t('bookmarksText')}`,
    description: t('bookmarksUpdated'),
});
```

### 4. **文件夹删除对话框**

#### 修改文件：`components/ui/folder-delete-dialog.tsx`

**修改前**：
```typescript
<span className="text-amber-600 dark:text-amber-400 font-medium">
    {t('folderContainsItems', { count: childrenCount })}
</span>
```

**修改后**：
```typescript
<span className="text-amber-600 dark:text-amber-400 font-medium">
    {t('folderContains')} {childrenCount} {t('itemsText')}
</span>
```

## 🌐 翻译文本更新

### 中文翻译 (`locales/zh_CN/common.json`)

**新增文本**：
```json
{
  "foundText": "找到",
  "bookmarksText": "个书签",
  "successfullyRenamed": "已成功重命名",
  "folderContains": "此文件夹包含",
  "itemsText": "个项目"
}
```

### 英文翻译 (`locales/en/common.json`)

**新增文本**：
```json
{
  "foundText": "Found",
  "bookmarksText": "bookmarks",
  "successfullyRenamed": "Successfully renamed",
  "folderContains": "This folder contains",
  "itemsText": "items"
}
```

## 🎨 显示效果对比

### 修改前（问题状态）
- ❌ "找到 {count} 个书签"
- ❌ "已成功重命名 {count} 个书签"
- ❌ "此文件夹包含 {count} 个项目"

### 修改后（正常显示）
- ✅ "找到 5 个书签"
- ✅ "已成功重命名 3 个书签"
- ✅ "此文件夹包含 8 个项目"

## 🔍 技术优势

### 1. **可靠性**
- 不依赖复杂的国际化占位符功能
- 使用简单的字符串拼接，兼容性更好
- 避免了 react-i18next 配置问题

### 2. **灵活性**
- 可以轻松调整数字的显示格式
- 支持添加额外的样式或组件
- 便于后续扩展和维护

### 3. **国际化友好**
- 每个语言可以独立调整文本顺序
- 支持不同语言的语法结构
- 保持了完整的多语言支持

## 📊 影响范围

### 修改的文件
- `entrypoints/newtab/batch-rename.tsx` - 批量重命名页面
- `components/ui/folder-delete-dialog.tsx` - 文件夹删除对话框
- `locales/zh_CN/common.json` - 中文翻译
- `locales/en/common.json` - 英文翻译

### 修复的功能
- ✅ 批量重命名页面的书签计数显示
- ✅ 文件夹选择后的Toast通知
- ✅ 重命名成功的Toast通知
- ✅ 文件夹删除确认对话框的项目计数

### 保持不变的功能
- ✅ 其他不使用占位符的翻译文本
- ✅ 基本的国际化切换功能
- ✅ 静态文本的多语言显示

## 🧪 测试验证

### 构建测试
```bash
npm run build
```
- ✅ 构建成功，无编译错误

### 功能测试
1. **批量重命名页面**
   - 选择文件夹后查看书签计数显示
   - 验证Toast通知中的数字显示

2. **文件夹删除功能**
   - 尝试删除包含子项目的文件夹
   - 验证确认对话框中的计数显示

3. **多语言测试**
   - 切换中英文界面
   - 验证两种语言下的数字显示

## 🎉 总结

通过将复杂的占位符文本拆分为简单的文本片段，我们成功规避了国际化占位符的技术问题，实现了可靠的数字显示功能。这种方案虽然增加了一些翻译文本条目，但大大提高了功能的稳定性和可维护性。

**核心优势**：
- 🔧 **技术可靠**：避免了复杂的i18n配置问题
- 🌐 **国际化友好**：支持不同语言的语法结构
- 🎯 **用户体验**：数字显示正确，信息清晰
- 🛠️ **易于维护**：代码简单直观，便于后续修改
