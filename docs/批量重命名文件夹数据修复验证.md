# æ‰¹é‡é‡å‘½åæ–‡ä»¶å¤¹æ•°æ®ä¿®å¤éªŒè¯

## ğŸ¯ ä¿®å¤ç›®æ ‡

ä¿®å¤AIæ‰¹é‡é‡å‘½åé¡µé¢ä¸­æ–‡ä»¶å¤¹æ•°æ®åŠ è½½é—®é¢˜ï¼Œç¡®ä¿ `CascadingFolderSelect` ç»„ä»¶èƒ½å¤Ÿæ­£ç¡®æ˜¾ç¤ºæ–‡ä»¶å¤¹çš„å±‚çº§ç»“æ„ã€‚

## âœ… ä¿®å¤å†…å®¹æ€»ç»“

### 1. **å‡½æ•°æ›¿æ¢**
- **åŸå‡½æ•°**ï¼š`getBookmarkFolders()` - è¿”å›å¹³é“ºçš„æ–‡ä»¶å¤¹åˆ—è¡¨
- **æ–°å‡½æ•°**ï¼š`getBookmarkFolderTree()` - è¿”å›å¸¦æœ‰å±‚çº§ç»“æ„çš„æ–‡ä»¶å¤¹æ ‘

### 2. **æ•°æ®ç»“æ„å¯¹æ¯”**

#### ä¿®å¤å‰ - å¹³é“ºç»“æ„ï¼ˆæ— æ³•æ”¯æŒçº§è”ï¼‰
```typescript
// getBookmarkFolders() è¿”å›çš„æ•°æ®
[
  { id: '1', title: 'ä¹¦ç­¾æ ', level: 0 },
  { id: '2', title: 'å¼€å‘å·¥å…·', level: 0 },
  { id: '3', title: 'React', level: 0 },
  { id: '4', title: 'Vue', level: 0 }
]
```

#### ä¿®å¤å - æ ‘å½¢ç»“æ„ï¼ˆæ”¯æŒçº§è”ï¼‰
```typescript
// getBookmarkFolderTree() è¿”å›çš„æ•°æ®
[
  {
    id: 'all',
    title: 'All Bookmarks',
    level: 0,
    children: []
  },
  {
    id: '1',
    title: 'ä¹¦ç­¾æ ',
    level: 0,
    children: [
      {
        id: '2',
        title: 'å¼€å‘å·¥å…·',
        level: 1,
        children: [
          { id: '3', title: 'React', level: 2, children: [] },
          { id: '4', title: 'Vue', level: 2, children: [] }
        ]
      }
    ]
  }
]
```

### 3. **ä»£ç ä¿®æ”¹è¯¦æƒ…**

#### å¯¼å…¥ä¿®æ”¹
```typescript
// ä¿®æ”¹å‰
import { getBookmarksInFolder, getBookmarkFolders } from '@/lib/bookmarkUtils';

// ä¿®æ”¹å
import { getBookmarksInFolder, getBookmarkFolderTree, BookmarkFolder } from '@/lib/bookmarkUtils';
```

#### æ•°æ®è·å–ä¿®æ”¹
```typescript
// ä¿®æ”¹å‰
const folderList = await getBookmarkFolders();
setFolders(folderList || []);

// ä¿®æ”¹å
const folderTree = await getBookmarkFolderTree();
setFolders(folderTree || []);
```

#### ç±»å‹å®šä¹‰ä¿®æ”¹
```typescript
// ä¿®æ”¹å‰
const [folders, setFolders] = useState<any[]>([]);
const findFolderName = (folders: any[], id: string): string => {

// ä¿®æ”¹å
const [folders, setFolders] = useState<BookmarkFolder[]>([]);
const findFolderName = (folders: BookmarkFolder[], id: string): string => {
```

## ğŸ§ª éªŒè¯æ­¥éª¤

### 1. **æ„å»ºéªŒè¯**
```bash
npm run build
```
- âœ… æ„å»ºæˆåŠŸï¼Œæ— ç¼–è¯‘é”™è¯¯
- âœ… ç±»å‹æ£€æŸ¥é€šè¿‡

### 2. **å¼€å‘æœåŠ¡å™¨éªŒè¯**
```bash
npm run dev
```
- âœ… å¼€å‘æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ
- âœ… çƒ­é‡è½½æ­£å¸¸å·¥ä½œ

### 3. **åŠŸèƒ½éªŒè¯**

#### åœ¨Chromeæ‰©å±•ä¸­æµ‹è¯•ï¼š

1. **åŠ è½½æ‰©å±•**
   - æ‰“å¼€ `chrome://extensions/`
   - åŠ è½½ `.output/chrome-mv3` ç›®å½•

2. **æµ‹è¯•æ‰¹é‡é‡å‘½åé¡µé¢**
   - æ‰“å¼€æ‰©å±•çš„æ–°æ ‡ç­¾é¡µ
   - ç‚¹å‡»ä¾§è¾¹æ çš„æ‰¹é‡é‡å‘½åæŒ‰é’®ï¼ˆSparkleså›¾æ ‡ï¼‰

3. **éªŒè¯æ–‡ä»¶å¤¹é€‰æ‹©å™¨**
   - âœ… åº”æ˜¾ç¤ºçº§è”é¢æ¿æ ·å¼çš„æ–‡ä»¶å¤¹é€‰æ‹©å™¨
   - âœ… æ‚¬åœåº”èƒ½å±•å¼€å­çº§æ–‡ä»¶å¤¹
   - âœ… å¤šé¢æ¿å¹¶æ’æ˜¾ç¤ºå±‚çº§å…³ç³»
   - âœ… ä¸è®¾ç½®é¡µé¢çš„æ–‡ä»¶å¤¹é€‰æ‹©å™¨ä½“éªŒä¸€è‡´

4. **éªŒè¯æ•°æ®ç»“æ„**
   - æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·
   - åœ¨Consoleä¸­æ£€æŸ¥ `folders` çŠ¶æ€
   - ç¡®è®¤åŒ…å« `children` å±æ€§

### 4. **å¯¹æ¯”éªŒè¯**

#### è®¾ç½®é¡µé¢ï¼ˆå‚è€ƒæ ‡å‡†ï¼‰
- è·¯å¾„ï¼šè®¾ç½® â†’ ä¹¦ç­¾è®¾ç½® â†’ æ ¹ç›®å½•é€‰æ‹©å™¨
- åº”æ˜¾ç¤ºçº§è”é¢æ¿ï¼Œæ”¯æŒæ‚¬åœå±•å¼€

#### æ‰¹é‡é‡å‘½åé¡µé¢ï¼ˆä¿®å¤åï¼‰
- è·¯å¾„ï¼šä¾§è¾¹æ  â†’ æ‰¹é‡é‡å‘½å â†’ æ–‡ä»¶å¤¹é€‰æ‹©å™¨
- åº”ä¸è®¾ç½®é¡µé¢ä¿æŒä¸€è‡´çš„äº¤äº’ä½“éªŒ

## ğŸ“Š é¢„æœŸæ•ˆæœ

### ä¿®å¤å‰çš„é—®é¢˜
- âŒ çº§è”é¢æ¿æ— æ³•å±•å¼€å­çº§
- âŒ åªæ˜¾ç¤ºå•å±‚æ–‡ä»¶å¤¹åˆ—è¡¨
- âŒ æ— æ³•æ­£ç¡®å¯¼èˆªæ·±å±‚æ–‡ä»¶å¤¹
- âŒ ä¸è®¾ç½®é¡µé¢ä½“éªŒä¸ä¸€è‡´

### ä¿®å¤åçš„æ•ˆæœ
- âœ… çº§è”é¢æ¿æ­£ç¡®æ˜¾ç¤ºå±‚çº§ç»“æ„
- âœ… æ‚¬åœå±•å¼€å­çº§æ–‡ä»¶å¤¹
- âœ… å¤šé¢æ¿å¹¶æ’æ˜¾ç¤ºï¼Œå¯¼èˆªæ¸…æ™°
- âœ… ä¸è®¾ç½®é¡µé¢å®Œå…¨ä¸€è‡´çš„ä½“éªŒ
- âœ… ç±»å‹å®‰å…¨ï¼Œæ— TypeScriptè­¦å‘Š

## ğŸ” æŠ€æœ¯åŸç†

### å…³é”®å·®å¼‚

#### buildFolderTree() vs collectFolders()

**buildFolderTree()** (ç”¨äºæ ‘å½¢ç»“æ„):
```typescript
const folder: BookmarkFolder = {
    id: node.id,
    title: node.title,
    parentId: node.parentId,
    path: node.title,
    level: level,
    children: buildFolderTree(node.children, level + 1) // é€’å½’æ„å»ºchildren
};
```

**collectFolders()** (ç”¨äºå¹³é“ºç»“æ„):
```typescript
folders.push({
    id: node.id,
    title: node.title,
    parentId: node.parentId,
    path: currentPath,
    level: 0 // æ— childrenå±æ€§
});
```

### CascadingFolderSelect ç»„ä»¶è¦æ±‚

çº§è”ç»„ä»¶éœ€è¦ `children` å±æ€§æ¥ï¼š
1. åˆ¤æ–­æ˜¯å¦æœ‰å­çº§æ–‡ä»¶å¤¹
2. æ„å»ºå¤šé¢æ¿æ˜¾ç¤º
3. å®ç°æ‚¬åœå±•å¼€åŠŸèƒ½
4. æ¸²æŸ“å±‚çº§å¯¼èˆª

## ğŸ‰ æ€»ç»“

é€šè¿‡å°† `getBookmarkFolders()` æ›¿æ¢ä¸º `getBookmarkFolderTree()`ï¼ŒæˆåŠŸè§£å†³äº†æ‰¹é‡é‡å‘½åé¡µé¢æ–‡ä»¶å¤¹é€‰æ‹©å™¨çš„å±‚çº§æ˜¾ç¤ºé—®é¢˜ã€‚ç°åœ¨ç”¨æˆ·å¯ä»¥äº«å—åˆ°ä¸è®¾ç½®é¡µé¢å®Œå…¨ä¸€è‡´çš„çº§è”æ–‡ä»¶å¤¹é€‰æ‹©ä½“éªŒï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤æ‚çš„æ–‡ä»¶å¤¹å±‚çº§ç»“æ„æ—¶æ›´åŠ ä¾¿æ·å’Œç›´è§‚ã€‚
