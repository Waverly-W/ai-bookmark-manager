# å›½é™…åŒ–å ä½ç¬¦ä¿®å¤

## ğŸ¯ é—®é¢˜æè¿°

åœ¨AIæ‰¹é‡é‡å‘½åé¡µé¢ä¸­ï¼Œæ˜¾ç¤º"æ‰¾åˆ° {count} ä¸ªä¹¦ç­¾"æ—¶ï¼Œå ä½ç¬¦ `{count}` æ²¡æœ‰è¢«å®é™…çš„æ•°å­—æ›¿æ¢ï¼Œè€Œæ˜¯æ˜¾ç¤ºä¸ºå­—é¢çš„ `{count}`ã€‚

## ğŸ” é—®é¢˜åˆ†æ

### ç—‡çŠ¶
- ç¿»è¯‘æ–‡æœ¬ï¼š`"bookmarksFound": "æ‰¾åˆ° {count} ä¸ªä¹¦ç­¾"`
- ä»£ç è°ƒç”¨ï¼š`t('bookmarksFound', { count: bookmarks.length })`
- å®é™…æ˜¾ç¤ºï¼š`"æ‰¾åˆ° {count} ä¸ªä¹¦ç­¾"` ï¼ˆå ä½ç¬¦æœªæ›¿æ¢ï¼‰
- æœŸæœ›æ˜¾ç¤ºï¼š`"æ‰¾åˆ° 5 ä¸ªä¹¦ç­¾"` ï¼ˆå ä½ç¬¦è¢«æ›¿æ¢ä¸ºå®é™…æ•°å­—ï¼‰

### æ ¹æœ¬åŸå› 

ç»è¿‡åˆ†æå‘ç°ä¸¤ä¸ªä¸»è¦é—®é¢˜ï¼š

1. **i18n æ’å€¼é…ç½®ç¼ºå¤±**
   - react-i18next çš„æ’å€¼åŠŸèƒ½æ²¡æœ‰æ˜ç¡®é…ç½®
   - ç¼ºå°‘ `interpolation` é…ç½®é¡¹

2. **å¼‚æ­¥åˆå§‹åŒ–é—®é¢˜**
   - `initTranslations` å‡½æ•°æ²¡æœ‰ä½¿ç”¨ `await` ç­‰å¾…å®Œæˆ
   - ç»„ä»¶å¯èƒ½åœ¨ i18n å®Œå…¨åˆå§‹åŒ–å‰å°±å¼€å§‹æ¸²æŸ“

## âœ… ä¿®å¤æ–¹æ¡ˆ

### 1. **æ·»åŠ æ’å€¼é…ç½®**

#### ä¿®æ”¹æ–‡ä»¶ï¼š`components/i18n.ts`

**ä¿®æ”¹å‰**ï¼š
```typescript
await i18nInstance.init({
    lng: locale,
    resources,
    fallbackLng: i18nConfig.defaultLocale,
    supportedLngs: i18nConfig.locales,
    defaultNS: namespaces[0],
    fallbackNS: namespaces[0],
    ns: namespaces,
    preload: resources ? [] : i18nConfig.locales
});
```

**ä¿®æ”¹å**ï¼š
```typescript
await i18nInstance.init({
    lng: locale,
    resources,
    fallbackLng: i18nConfig.defaultLocale,
    supportedLngs: i18nConfig.locales,
    defaultNS: namespaces[0],
    fallbackNS: namespaces[0],
    ns: namespaces,
    preload: resources ? [] : i18nConfig.locales,
    interpolation: {
        escapeValue: false // React already does escaping
    }
});
```

### 2. **ä¿®å¤å¼‚æ­¥åˆå§‹åŒ–**

#### ä¿®æ”¹æ–‡ä»¶ï¼š`entrypoints/newtab/main.tsx`

**ä¿®æ”¹å‰**ï¼š
```typescript
initTranslations(i18nConfig.defaultLocale,["common","newtab"])

// åˆå§‹åŒ–å¼ºè°ƒè‰²
initializeAccentColor().catch(console.error);

ReactDOM.createRoot(document.getElementById('root')!).render(
    <React.StrictMode>
        <ThemeProvider>
            <App/>
        </ThemeProvider>
    </React.StrictMode>,
);
```

**ä¿®æ”¹å**ï¼š
```typescript
async function initApp() {
    // åˆå§‹åŒ–å›½é™…åŒ–
    await initTranslations(i18nConfig.defaultLocale, ["common", "newtab"]);
    
    // åˆå§‹åŒ–å¼ºè°ƒè‰²
    await initializeAccentColor();
    
    // æ¸²æŸ“åº”ç”¨
    ReactDOM.createRoot(document.getElementById('root')!).render(
        <React.StrictMode>
            <ThemeProvider>
                <App/>
            </ThemeProvider>
        </React.StrictMode>,
    );
}

initApp().catch(console.error);
```

## ğŸ”§ æŠ€æœ¯åŸç†

### æ’å€¼åŠŸèƒ½

react-i18next çš„æ’å€¼åŠŸèƒ½å…è®¸åœ¨ç¿»è¯‘æ–‡æœ¬ä¸­ä½¿ç”¨å ä½ç¬¦ï¼š

```typescript
// ç¿»è¯‘æ–‡ä»¶
{
  "bookmarksFound": "æ‰¾åˆ° {count} ä¸ªä¹¦ç­¾"
}

// ä»£ç ä¸­ä½¿ç”¨
t('bookmarksFound', { count: 5 })
// ç»“æœ: "æ‰¾åˆ° 5 ä¸ªä¹¦ç­¾"
```

### é…ç½®è¯´æ˜

- **`escapeValue: false`**ï¼šç¦ç”¨HTMLè½¬ä¹‰ï¼Œå› ä¸ºReactå·²ç»å¤„ç†äº†XSSé˜²æŠ¤
- **å¼‚æ­¥åˆå§‹åŒ–**ï¼šç¡®ä¿i18nå®Œå…¨åŠ è½½åå†æ¸²æŸ“ç»„ä»¶

## ğŸ§ª éªŒè¯æ–¹æ³•

### 1. **æ„å»ºæµ‹è¯•**
```bash
npm run build
```
- âœ… æ„å»ºæˆåŠŸï¼Œæ— é”™è¯¯

### 2. **åŠŸèƒ½æµ‹è¯•**

åœ¨Chromeæ‰©å±•ä¸­æµ‹è¯•ï¼š

1. **åŠ è½½æ‰©å±•**
   - æ‰“å¼€ `chrome://extensions/`
   - åŠ è½½ `.output/chrome-mv3` ç›®å½•

2. **æµ‹è¯•æ‰¹é‡é‡å‘½åé¡µé¢**
   - æ‰“å¼€æ‰©å±•çš„æ–°æ ‡ç­¾é¡µ
   - ç‚¹å‡»ä¾§è¾¹æ çš„æ‰¹é‡é‡å‘½åæŒ‰é’®
   - é€‰æ‹©ä¸€ä¸ªåŒ…å«ä¹¦ç­¾çš„æ–‡ä»¶å¤¹

3. **éªŒè¯å ä½ç¬¦æ›¿æ¢**
   - âœ… åº”æ˜¾ç¤º "æ‰¾åˆ° X ä¸ªä¹¦ç­¾"ï¼ˆXä¸ºå®é™…æ•°å­—ï¼‰
   - âœ… ä¸åº”æ˜¾ç¤º "æ‰¾åˆ° {count} ä¸ªä¹¦ç­¾"

### 3. **å…¶ä»–å ä½ç¬¦æµ‹è¯•**

åŒæ—¶éªŒè¯å…¶ä»–ä½¿ç”¨å ä½ç¬¦çš„æ–‡æœ¬ï¼š
- `t('batchRenameSuccess', { count: successCount })`
- `t('folderContainsItems', { count: childrenCount })`
- `t('confirmApplyMessage', { count: selectedCount })`

## ğŸ“Š å½±å“èŒƒå›´

### ä¿®å¤çš„åŠŸèƒ½
- âœ… æ‰¹é‡é‡å‘½åé¡µé¢çš„ä¹¦ç­¾è®¡æ•°æ˜¾ç¤º
- âœ… æˆåŠŸé‡å‘½åçš„ä¹¦ç­¾è®¡æ•°æ˜¾ç¤º
- âœ… æ–‡ä»¶å¤¹åŒ…å«é¡¹ç›®çš„è®¡æ•°æ˜¾ç¤º
- âœ… ç¡®è®¤åº”ç”¨ä¿®æ”¹çš„è®¡æ•°æ˜¾ç¤º

### ä¸å—å½±å“çš„åŠŸèƒ½
- âœ… å…¶ä»–ä¸ä½¿ç”¨å ä½ç¬¦çš„ç¿»è¯‘æ–‡æœ¬
- âœ… åŸºæœ¬çš„å›½é™…åŒ–åˆ‡æ¢åŠŸèƒ½
- âœ… é™æ€ç¿»è¯‘æ–‡æœ¬æ˜¾ç¤º

## ğŸ‰ ä¿®å¤æ•ˆæœ

### ä¿®å¤å‰
- âŒ æ˜¾ç¤ºï¼š`"æ‰¾åˆ° {count} ä¸ªä¹¦ç­¾"`
- âŒ æ˜¾ç¤ºï¼š`"å·²æˆåŠŸé‡å‘½å {count} ä¸ªä¹¦ç­¾"`
- âŒ æ˜¾ç¤ºï¼š`"æ­¤æ–‡ä»¶å¤¹åŒ…å« {count} ä¸ªé¡¹ç›®"`

### ä¿®å¤å
- âœ… æ˜¾ç¤ºï¼š`"æ‰¾åˆ° 5 ä¸ªä¹¦ç­¾"`
- âœ… æ˜¾ç¤ºï¼š`"å·²æˆåŠŸé‡å‘½å 3 ä¸ªä¹¦ç­¾"`
- âœ… æ˜¾ç¤ºï¼š`"æ­¤æ–‡ä»¶å¤¹åŒ…å« 8 ä¸ªé¡¹ç›®"`

## ğŸ” ç›¸å…³æ–‡ä»¶

- **ä¿®æ”¹æ–‡ä»¶**ï¼š
  - `components/i18n.ts` - æ·»åŠ æ’å€¼é…ç½®
  - `entrypoints/newtab/main.tsx` - ä¿®å¤å¼‚æ­¥åˆå§‹åŒ–
- **ç¿»è¯‘æ–‡ä»¶**ï¼š
  - `locales/zh_CN/common.json` - ä¸­æ–‡ç¿»è¯‘
  - `locales/en/common.json` - è‹±æ–‡ç¿»è¯‘
- **ä½¿ç”¨æ–‡ä»¶**ï¼š
  - `entrypoints/newtab/batch-rename.tsx` - æ‰¹é‡é‡å‘½åé¡µé¢
  - `components/ui/folder-delete-dialog.tsx` - æ–‡ä»¶å¤¹åˆ é™¤å¯¹è¯æ¡†

## ğŸ“ æœ€ä½³å®è·µ

### å ä½ç¬¦ä½¿ç”¨è§„èŒƒ

```typescript
// âœ… æ­£ç¡®çš„å ä½ç¬¦ä½¿ç”¨
t('messageWithCount', { count: number, name: string })

// âœ… ç¿»è¯‘æ–‡ä»¶æ ¼å¼
{
  "messageWithCount": "æ‰¾åˆ° {count} ä¸ª {name}"
}

// âŒ é¿å…çš„å†™æ³•
t('messageWithCount') + count + 'ä¸ªä¹¦ç­¾'
```

### i18n é…ç½®å»ºè®®

```typescript
// âœ… æ¨èçš„é…ç½®
interpolation: {
    escapeValue: false, // Reactç¯å¢ƒä¸‹ç¦ç”¨HTMLè½¬ä¹‰
    format: function(value, format, lng) {
        // å¯ä»¥æ·»åŠ è‡ªå®šä¹‰æ ¼å¼åŒ–é€»è¾‘
        if (format === 'number') return new Intl.NumberFormat(lng).format(value);
        return value;
    }
}
```

è¿™æ¬¡ä¿®å¤ç¡®ä¿äº†æ‰€æœ‰ä½¿ç”¨å ä½ç¬¦çš„å›½é™…åŒ–æ–‡æœ¬éƒ½èƒ½æ­£ç¡®æ˜¾ç¤ºï¼Œæå‡äº†ç”¨æˆ·ä½“éªŒçš„ä¸€è‡´æ€§å’Œä¸“ä¸šæ€§ã€‚
