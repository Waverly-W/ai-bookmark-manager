# 书签删除功能说明

## 概述

为主页书签右键菜单添加了删除功能，用户可以通过右键点击书签卡片来删除不需要的书签。

## 主要功能

### 🗑️ 删除功能

1. **右键菜单**: 在书签卡片上右键点击显示上下文菜单
2. **删除选项**: 菜单中包含"删除"选项，使用红色文字和垃圾桶图标
3. **确认对话框**: 点击删除后弹出确认对话框，防止误删
4. **安全删除**: 使用Chrome的bookmarks API安全删除书签

### 🎨 界面设计

1. **右键菜单布局**:
   - 编辑选项（铅笔图标）
   - 分隔线
   - 删除选项（垃圾桶图标，红色文字）

2. **确认对话框**:
   - 清晰的标题："删除书签"
   - 显示要删除的书签名称
   - 警告文字："此操作无法撤销"
   - 取消和删除按钮

3. **视觉反馈**:
   - 删除按钮使用危险色彩（红色）
   - 删除过程中显示加载状态
   - 成功删除后显示Toast提示

### 🔧 技术实现

#### 1. **组件结构**

```typescript
// 书签卡片组件增加删除回调
interface BookmarkCardProps {
    item: BookmarkCardItem;
    onClick: (item: BookmarkCardItem) => void;
    onEdit?: (item: BookmarkCardItem) => void;
    onDelete?: (item: BookmarkCardItem) => void; // 新增
    className?: string;
}
```

#### 2. **删除确认对话框**

```typescript
// 新增删除确认对话框组件
export const BookmarkDeleteDialog: React.FC<BookmarkDeleteDialogProps> = ({
    open,
    onOpenChange,
    bookmark,
    onConfirm,
    isDeleting = false
}) => {
    // 使用AlertDialog组件实现确认对话框
}
```

#### 3. **Chrome API调用**

```typescript
// 删除书签的API函数
export const deleteChromeBookmark = async (id: string): Promise<void> => {
    try {
        await browser.bookmarks.remove(id);
    } catch (error) {
        console.error('Failed to delete Chrome bookmark:', error);
        throw new Error('Failed to delete bookmark from Chrome');
    }
};
```

#### 4. **状态管理**

```typescript
// 书签组件中的删除相关状态
const [deletingBookmark, setDeletingBookmark] = useState<BookmarkCardItem | null>(null);
const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);
const [isDeleting, setIsDeleting] = useState(false);
```

### 📋 使用流程

1. **触发删除**: 用户右键点击书签卡片
2. **选择删除**: 在上下文菜单中点击"删除"选项
3. **确认删除**: 在弹出的确认对话框中点击"删除"按钮
4. **执行删除**: 系统调用Chrome API删除书签
5. **更新界面**: 从本地状态中移除已删除的书签
6. **反馈提示**: 显示删除成功的Toast消息

### 🛡️ 安全措施

1. **二次确认**: 必须通过确认对话框才能执行删除
2. **错误处理**: 删除失败时显示错误提示
3. **状态保护**: 删除过程中禁用相关按钮
4. **数据同步**: 删除后立即更新本地状态

### 🌐 国际化支持

添加了以下翻译键：

- `delete`: "删除" / "Delete"
- `deleteBookmark`: "删除书签" / "Delete Bookmark"
- `deleteBookmarkConfirm`: "确定要删除这个书签吗？" / "Are you sure you want to delete this bookmark?"
- `deleteBookmarkDescription`: "此操作无法撤销" / "This action cannot be undone"
- `bookmarkDeleted`: "书签已删除" / "Bookmark deleted"
- `deleteBookmarkFailed`: "删除书签失败" / "Failed to delete bookmark"

### 📦 依赖更新

新增依赖：
- `@radix-ui/react-alert-dialog`: 用于实现确认对话框

### 🎯 注意事项

1. **仅限书签**: 删除功能只对书签有效，文件夹不显示删除选项
2. **权限要求**: 需要`bookmarks`权限才能删除书签
3. **实时更新**: 删除后界面立即更新，无需刷新页面
4. **错误恢复**: 删除失败时保持原有状态不变

## 文件变更

### 新增文件
- `components/ui/alert-dialog.tsx`: AlertDialog组件
- `components/ui/bookmark-delete-dialog.tsx`: 删除确认对话框
- `docs/书签删除功能说明.md`: 本文档

### 修改文件
- `components/ui/bookmark-card.tsx`: 添加删除菜单项
- `entrypoints/newtab/bookmarks.tsx`: 添加删除处理逻辑
- `lib/bookmarkUtils.ts`: 添加删除API函数
- `locales/zh_CN/common.json`: 添加中文翻译
- `locales/en/common.json`: 添加英文翻译
- `package.json`: 添加alert-dialog依赖

## 测试建议

1. **功能测试**: 验证删除功能是否正常工作
2. **界面测试**: 检查右键菜单和确认对话框显示
3. **错误测试**: 测试删除失败时的错误处理
4. **国际化测试**: 验证中英文界面显示正确
5. **权限测试**: 确认在不同权限下的行为
